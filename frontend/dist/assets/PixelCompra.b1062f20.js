import{P as N}from"./PixelSumCard.e0103430.js";import{d as E,h as c,M as g,_ as C,r as x,o as i,c as l,a as n,F as S,l as $,n as m,k as P,b as p,w as h,m as I,e as _,p as A,f as v,q as M,s as R,t as F}from"./index.f324766f.js";import{h as B}from"./moment.9709ab41.js";import{s as b}from"./themesUtil.c377a4d3.js";const q=20,z=E({name:"render-nft",props:{nftMeasurement:{required:!0,type:Object,default:null},pixelSize:{required:!1,type:Number,default:q},edittable:{required:!1,type:Boolean,default:!1}},setup(){return{showModal:c(!1),pixelSelected:c({}),pixelsSelectedForBuy:c([]),moment:B}},methods:{openColorModal(e){e.isAvailible?(this.showModal=!this.showModal,this.pixelSelected=e):this.$store.commit(g.SET_NOTIFICATION,{title:"Ate\xE7\xE3o",message:"Este pixel j\xE1 foi comprado!",color:"warning"})},setPixelColor(e){const t=this.changePieceColor(this.pixelSelected,e);this.pixelsSelectedForBuy.push(t),this.showModal=!1,this.$emit("pixelsSelectedForBuy",this.pixelsSelectedForBuy)},clearPixelSelection(){this.pixelsSelectedForBuy.forEach((e,t,o)=>{e.uuid===this.pixelSelected.uuid&&(o[t].color="white")}),this.pixelsSelectedForBuy=this.pixelsSelectedForBuy.filter(e=>e.uuid!==this.pixelSelected.uuid),this.showModal=!1},clearAll(){this.pixelsSelectedForBuy.forEach((e,t,o)=>{o[t].color="white"}),this.pixelsSelectedForBuy=[],this.showModal=!1},changePieceColor(e,t){var a,r;let o;return(r=(a=this.nftMeasurement)==null?void 0:a.nft.chunks)==null||r.forEach(u=>{u.position===e.chunkPosition&&u.pixels.forEach((d,f,s)=>{d.position===e.position&&(s[f].color=t,o=s[f])})}),o},themes(){return this.nftMeasurement?b(this.nftMeasurement.themes):[]},updatePixelsFromCartToNFT(e){var o;const t=[...this.pixelsSelectedForBuy];((o=e==null?void 0:e.pixels)==null?void 0:o.length)>0&&e.pixels.forEach(a=>{var u;const r=(u=this.nftMeasurement)==null?void 0:u.nft.chunks[a.chunkPosition].pixels[a.position];r&&(r.color=a.color,t.find(d=>d._id===r._id)||t.push(r))}),t.length>0&&(this.pixelsSelectedForBuy=t)}}}),O=n("div",{class:"tw-w-full tw-h-full tw-flex tw-p-5 image-pixel"},[n("img",{src:A,alt:""})],-1),D=[O],W=["onClick"],L=n("h2",null,"Selecione a cor:",-1),V={key:0,class:"tw-flex tw-justify-between tw-mt-3"},j=["onClick"],G={key:1},U={class:"tw-flex tw-flex-col"},X=_(" Limpar "),Y=_(" Limpar todos ");function Z(e,t,o,a,r,u){const d=x("va-button"),f=x("va-modal");return i(),l("div",{style:m({maxWidth:e.nftMeasurement.NFTWidth+"px"}),class:"tw-overflow-x-auto"},[n("div",{style:m({minWidth:e.nftMeasurement.NFTWidth+"px"}),class:"tw-bg-gray-200 tw-m-auto tw-flex tw-flex-wrap tw-shadow-2xl"},[(i(!0),l(S,null,$(e.nftMeasurement.nft.chunks,(s,w)=>(i(),l("div",{key:w,class:"tw-flex tw-flex-wrap"},[s.position==4?(i(),l("div",{key:0,style:m({width:e.nftMeasurement.chunkWidth+"px",height:e.nftMeasurement.chunkWidth+"px"}),class:""},D,4)):P("",!0),n("div",{style:m({width:e.nftMeasurement.chunkWidth+"px",height:e.nftMeasurement.chunkWidth+"px"}),class:"tw-flex tw-flex-wrap"},[(i(!0),l(S,null,$(s.pixels,(y,k)=>(i(),l("div",{onClick:re=>e.openColorModal(y),key:k,style:m(`background-color: ${y.color}; width: ${e.pixelSize}px; height: ${e.pixelSize}px;`),class:"square"},null,12,W))),128))],4)]))),128))],4),p(f,{modelValue:e.showModal,"onUpdate:modelValue":t[2]||(t[2]=s=>e.showModal=s),"hide-default-actions":"","overlay-opacity":"0.2"},{header:h(()=>[L]),footer:h(()=>[n("div",U,[p(d,{onClick:t[0]||(t[0]=s=>e.clearPixelSelection())},{default:h(()=>[X]),_:1}),p(d,{class:"tw-mt-2",flat:"",size:"small",onClick:t[1]||(t[1]=s=>e.clearAll())},{default:h(()=>[Y]),_:1})])]),default:h(()=>[I(e.$slots,"default",{},()=>[e.themes().length>0?(i(),l("div",V,[(i(!0),l(S,null,$(e.themes(),(s,w)=>(i(),l("div",{class:"tw-h-8 tw-w-8 tw-cursor-pointer hover:tw-opacity-80",onClick:y=>e.setPixelColor(`#${s}`),key:w,style:m(`background-color: #${s}`)},null,12,j))),128))])):(i(),l("div",G,"N\xE3o foram encontradas as cores..."))])]),_:3},8,["modelValue"])],4)}var H=C(z,[["render",Z]]);const T=20,J=E({name:"pixel",components:{PixelSumCard:N,RenderNFT:H},setup(){return{showModal:c(!1),pixelSelected:c({}),pixelsSelectedForBuy:c([]),moment:B,pixelSize:T,childComponentRef:c()}},mounted(){var e,t;(e=this.$route.query)!=null&&e.sortitionId?this.$store.dispatch(v.GET_SORTITION_BY_ID,(t=this.$route.query)==null?void 0:t.sortitionId):this.$store.dispatch(v.DEFINE_SELECTED_SORTITION_RANDOMLY)},methods:{onBuyPixel(){var t;this.$store.dispatch(M.UPDATE_CART,this.pixelsSelectedForBuy);const e=(t=this.sortition)==null?void 0:t._id;this.$router.push({name:"checkout",query:{sortitionId:e}})},updatePixelsSelectedForBuy(e){this.pixelsSelectedForBuy=e}},computed:{sortition(){var e;return(e=this.$store.state.SortitionModule)==null?void 0:e.selectedSortition},nftMeasurement(){var e;return(e=this.$store.state.NFTModule)==null?void 0:e.nftMeasurement},user(){return this.$store.state.user},cart(){var e;return((e=this.$store.state.NFTModule)==null?void 0:e.nftMeasurement)&&this.$store.state.CartModule.cart?this.$store.state.CartModule.cart:void 0}},watch:{sortition(e){e&&(this.$store.dispatch(R.GET_NFT_MEASUREMENT,{nftId:e.idNFTSummary,pixelSize:T}),this.$store.dispatch(M.GET_CART,e._id))},nftMeasurement(e){var t,o;e&&this.cart&&((o=(t=this.childComponentRef)==null?void 0:t.value)==null||o.updatePixelsFromCartToNFT(this.cart))}}}),K={key:0,class:"tw-w-full tw-h-full"},Q={class:"tw-mb-5"},ee={class:"tw-text-xl"},te=_(" O sorteio ocorrer\xE1 "),oe=_(" voc\xEA pode ganhar at\xE9 "),se={class:"tw-flex tw-flex-col md:tw-flex-row"},ie={class:"md:tw-pl-5 tw-mt-5 md:tw-mt-0 md:tw-max-w-sm"},le={key:1};function ne(e,t,o,a,r,u){const d=x("va-card-content"),f=x("va-card"),s=x("RenderNFT"),w=x("PixelSumCard");return e.sortition&&e.nftMeasurement?(i(),l("div",K,[n("div",Q,[p(f,null,{default:h(()=>[p(d,null,{default:h(()=>[n("div",ee,[te,n("strong",null,F(e.moment(e.sortition.date).format("DD/MM/yyyy")+", "),1),oe,n("strong",null,F("R$ "+e.sortition.reward),1)])]),_:1})]),_:1})]),n("div",se,[p(s,{ref:"childComponentRef",nftMeasurement:e.nftMeasurement,edittable:!0,pixelSize:e.pixelSize,onPixelsSelectedForBuy:e.updatePixelsSelectedForBuy},null,8,["nftMeasurement","pixelSize","onPixelsSelectedForBuy"]),n("div",ie,[p(w,{pixels:e.pixelsSelectedForBuy,hideBuyButton:!1,onOnBuyPixel:t[0]||(t[0]=y=>e.onBuyPixel())},null,8,["pixels"])])])])):(i(),l("div",le,"Sem sorteios por agora..."))}var ce=C(J,[["render",ne]]);export{ce as default};
